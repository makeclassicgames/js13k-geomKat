(function () {
  'use strict';

  /**
   * @preserve
   * Kontra.js v10.0.2
   */
  function rotatePoint(t,e){let i=Math.sin(e),s=Math.cos(e);return {x:t.x*s-t.y*i,y:t.x*i+t.y*s}}function clamp(t,e,i){return Math.min(Math.max(t,i),e)}let noop=()=>{};function removeFromArray(t,e){let i=t.indexOf(e);if(-1!=i)return t.splice(i,1),true}let canvasEl,context,callbacks$2={};function on(t,e){callbacks$2[t]=callbacks$2[t]||[],callbacks$2[t].push(e);}function emit(t,...e){(callbacks$2[t]||[]).map((t=>t(...e)));}let handler$1={get:(t,e)=>"_proxy"==e||noop};function getContext(){return context}function init$1(t,{contextless:e=false}={}){if(canvasEl=document.getElementById(t)||t||document.querySelector("canvas"),e&&(canvasEl=canvasEl||new Proxy({},handler$1)),!canvasEl)throw Error("You must provide a canvas element for the game");return context=canvasEl.getContext("2d")||new Proxy({},handler$1),context.imageSmoothingEnabled=false,emit("init"),{canvas:canvasEl,context:context}}class Vector{constructor(t=0,e=0,i={}){null!=t.x?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e),i._c&&(this.clamp(i._a,i._b,i._d,i._e),this.x=t,this.y=e);}set(t){this.x=t.x,this.y=t.y;}add(t){return new Vector(this.x+t.x,this.y+t.y,this)}subtract(t){return new Vector(this.x-t.x,this.y-t.y,this)}scale(t){return new Vector(this.x*t,this.y*t)}normalize(t=this.length()||1){return new Vector(this.x/t,this.y/t)}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.hypot(this.x,this.y)}distance(t){return Math.hypot(this.x-t.x,this.y-t.y)}angle(t){return Math.acos(this.dot(t)/(this.length()*t.length()))}direction(){return Math.atan2(this.y,this.x)}clamp(t,e,i,s){this._c=true,this._a=t,this._b=e,this._d=i,this._e=s;}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?clamp(this._a,this._d,t):t;}set y(t){this._y=this._c?clamp(this._b,this._e,t):t;}}function factory$a(){return new Vector(...arguments)}class Updatable{constructor(t){return this.init(t)}init(t={}){this.position=factory$a(),this.velocity=factory$a(),this.acceleration=factory$a(),this.ttl=1/0,Object.assign(this,t);}update(t){this.advance(t);}advance(t){let e=this.acceleration;t&&(e=e.scale(t)),this.velocity=this.velocity.add(e);let i=this.velocity;t&&(i=i.scale(t)),this.position=this.position.add(i),this._pc(),this.ttl--;}get dx(){return this.velocity.x}get dy(){return this.velocity.y}set dx(t){this.velocity.x=t;}set dy(t){this.velocity.y=t;}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}set ddx(t){this.acceleration.x=t;}set ddy(t){this.acceleration.y=t;}isAlive(){return this.ttl>0}_pc(){}}class GameObject extends Updatable{init({width:t=0,height:e=0,context:i=getContext(),render:s=this.draw,update:a=this.advance,children:n=[],anchor:r={x:0,y:0},opacity:o=1,rotation:h=0,drotation:d=0,ddrotation:l=0,scaleX:c=1,scaleY:u=1,...p}={}){this._c=[],super.init({width:t,height:e,context:i,anchor:r,opacity:o,rotation:h,drotation:d,ddrotation:l,scaleX:c,scaleY:u,...p}),this._di=true,this._uw(),this.addChild(n),this._rf=s,this._uf=a,on("init",(()=>{this.context??=getContext();}));}update(t){this._uf(t),this.children.map((e=>e.update&&e.update(t)));}render(){let t=this.context;t.save(),(this.x||this.y)&&t.translate(this.x,this.y),this.rotation&&t.rotate(this.rotation),1==this.scaleX&&1==this.scaleY||t.scale(this.scaleX,this.scaleY);let e=this.width,i=this.height;this.radius&&(e=i=2*this.radius);let s=-e*this.anchor.x,a=-i*this.anchor.y;(s||a)&&t.translate(s,a),this.context.globalAlpha=this.opacity,this._rf(),(s||a)&&t.translate(-s,-a),this.children.map((t=>t.render&&t.render())),t.restore();}draw(){}_pc(){this._uw(),this.children.map((t=>t._pc()));}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this._pc();}set y(t){this.position.y=t,this._pc();}get width(){return this._w}set width(t){this._w=t,this._pc();}get height(){return this._h}set height(t){this._h=t,this._pc();}_uw(){if(!this._di)return;let{_wx:t=0,_wy:e=0,_wo:i=1,_wrot:s=0,_wsx:a=1,_wsy:n=1}=this.parent||{};this._wx=this.x,this._wy=this.y,this._ww=this.width,this._wh=this.height,this.radius&&(this._wrx=this.radius,this._wry=this.radius),this._wo=i*this.opacity,this._wsx=a*this.scaleX,this._wsy=n*this.scaleY,this._wx=this._wx*a,this._wy=this._wy*n,this._ww=this.width*this._wsx,this._wh=this.height*this._wsy,this.radius&&(this._wrx=this.radius*this._wsx,this._wry=this.radius*this._wsy),this._wrot=s+this.rotation;let{x:r,y:o}=rotatePoint({x:this._wx,y:this._wy},s);this._wx=r,this._wy=o,this._wx+=t,this._wy+=e;}get world(){return {x:this._wx,y:this._wy,width:this._ww,height:this._wh,radius:this.radius?{x:this._wrx,y:this._wry}:void 0,opacity:this._wo,rotation:this._wrot,scaleX:this._wsx,scaleY:this._wsy}}set children(t){this.removeChild(this._c),this.addChild(t);}get children(){return this._c}addChild(...t){t.flat().map((t=>{this.children.push(t),t.parent=this,t._pc=t._pc||noop,t._pc();}));}removeChild(...t){t.flat().map((t=>{removeFromArray(this.children,t)&&(t.parent=null,t._pc());}));}get radius(){return this._r}set radius(t){this._r=t,this._pc();}get opacity(){return this._opa}set opacity(t){this._opa=clamp(0,1,t),this._pc();}get rotation(){return this._rot}set rotation(t){this._rot=t,this._pc();}advance(t){super.advance(t),this.drotation+=this.ddrotation,this.rotation+=this.drotation;}setScale(t,e=t){this.scaleX=t,this.scaleY=e;}get scaleX(){return this._scx}set scaleX(t){this._scx=t,this._pc();}get scaleY(){return this._scy}set scaleY(t){this._scy=t,this._pc();}}class Sprite extends GameObject{init({image:t,width:e=(t?t.width:void 0),height:i=(t?t.height:void 0),...s}={}){super.init({image:t,width:e,height:i,...s});}get animations(){return this._a}set animations(t){let e,i;for(e in this._a={},t)this._a[e]=t[e].clone(),i=i||this._a[e];this.currentAnimation=i,this.width=this.width||i.width,this.height=this.height||i.height;}playAnimation(t){this.currentAnimation?.stop(),this.currentAnimation=this.animations[t],this.currentAnimation.start();}advance(t){super.advance(t),this.currentAnimation?.update(t);}draw(){if(this.image&&this.context.drawImage(this.image,0,0,this.image.width,this.image.height),this.currentAnimation&&this.currentAnimation.render({x:0,y:0,width:this.width,height:this.height,context:this.context}),this.color){if(this.context.fillStyle=this.color,this.radius)return this.context.beginPath(),this.context.arc(this.radius,this.radius,this.radius,0,2*Math.PI),void this.context.fill();this.context.fillRect(0,0,this.width,this.height);}}}function factory$8(){return new Sprite(...arguments)}function clear(t){let e=t.canvas;t.clearRect(0,0,e.width,e.height);}function GameLoop({fps:t=60,clearCanvas:e=true,update:i=noop,render:s,context:a=getContext(),blur:n=false}={}){if(!s)throw Error("You must provide a render() function");let r,o,h,d,l,c=0,u=1e3/t,p=1/t,g=e?clear:noop,f=true;function m(){if(o=requestAnimationFrame(m),f&&(h=performance.now(),d=h-r,r=h,!(d>1e3))){for(c+=d;c>=u;)emit("tick"),l.update(p),c-=u;g(l.context),l.render();}}return n||(window.addEventListener("focus",(()=>{f=true;})),window.addEventListener("blur",(()=>{f=false;}))),on("init",(()=>{l.context??=getContext();})),l={update:i,render:s,isStopped:true,context:a,start(){this.isStopped&&(r=performance.now(),this.isStopped=false,requestAnimationFrame(m));},stop(){this.isStopped=true,cancelAnimationFrame(o);},_frame:m,set _last(t){r=t;}},l}

  // game.js

  init$1();

  let sprite = factory$8({
    x: 100,
    y: 100,
    dx: 2,
    width: 20,
    height: 40,
    color: 'red'
  });

  let loop = GameLoop({
    update() {
      sprite.update();
    },
    render() {
      sprite.render();
    }
  });

  loop.start();

})();
